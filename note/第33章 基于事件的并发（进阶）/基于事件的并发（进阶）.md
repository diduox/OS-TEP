#### 基于事件的并发（进阶）

目前为止，我们提到的并发，似乎只能用线程来实现。但是，一些基于图形用户界面（GUI）的应用，或者某些类型的网络服务器，常常采用另一种并发方式。这种方式称为基于事件的并发（event-based concurrency），在一些现代系统中较为流行，比如node.js，但他源自于C/UNIX系统。

基于事件并发针对两方面问题。一是多线程应用中，正确处理并发很有难度。另一方面，开发者无法控制多线程在某一时刻的调度。因此某些时候操作系统的调度并不是最优的。

> **关键问题：不用线程，如何构建并发服务器** 
>
> 不用线程，同时保证对并发的控制，避免多线程应用中出现的问题，我们应该如何构建一个并发服 务器？

##### 33.1 基本想法：事件循环

我们使用的基本方法就是基于事件的并发（event-based concurrency）。该方法很简单：我们等待某事（即“事件”）发生；当它发生时，检查事件类型，然后做少量的相应工作（可能是I/O请求，或者调度其他事件准备后续处理）。这就好了！

我们先看一个典型的基于事件的服务器。这种应用都是基于一个简单的结构，称为事件循环（event loop）。事件循环的伪代码如下：

```c
while (1) { 
 events = getEvents(); 
 for (e in events) 
 processEvent(e); 
}
```

